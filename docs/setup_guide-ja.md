## 各ディレクトリ・ファイルの役割詳細
プロジェクトの主要なファイルとディレクトリの役割は以下の通りです。
### imageRAG_UI.py:
・システムのメインエントリポイント。Streamlitを使用したWebインターフェースを提供し、プロンプト入力、生成プロセスの制御、画像のプレビューとダウンロードを管理します。
### imageRAG_SDXL.py:
・画像生成のコアロジック。Stable Diffusion XL (SDXL) と IP-Adapter を使用した画像生成パイプラインを定義しています。LLMによるプロンプト拡張機能もここに実装されています。
### environment.yml:
・実行環境定義ファイル。Apple Silicon (M1/M2/M3 Mac) のGPU（MPS）を最大限活用するためのPyTorch設定や、必要なライブラリ一式が定義されています。
### retrieval.py:
・参照画像データセットから、プロンプトに最適な画像を検索・抽出するためのロジックを担います。
### utils.py:
・画像処理や判定ロジックなど、システム全体で使用される共通ユーティリティ関数が含まれています。
### datasets/:
・この中に作成したフォルダ名（例：Tokyo_dataset）が、Web UI上の「使用するデータセットを選択」というプルダウンメニューに自動的に反映されます。

・各フォルダ内には、参照したい画像（.jpg, .png, .jpeg）を自由に配置してください。
## プロジェクトのディレクトリ構成
システムを正しく動作させるためのファイル配置は以下の通りです。
```
project/
├── datasets/                # 参照画像データを格納するルートフォルダ
│   ├── Tokyo_dataset/       # 特定のテーマ（例：東京の風景）のデータセット
│   │   ├── bridge_01.jpg    # 個別の画像ファイル
│   │   ├── bridge_02.jpg
│   │   └── embeddings/      # (自動生成) 検索を高速化するためのベクトルデータ
│   └── Animal_dataset/      # 別のテーマのデータセット
├── results/                 # (自動生成) 生成された画像や一時ファイルが保存される
├── imageRAG_UI.py           # Web UI（Streamlit）のメインプログラム
├── imageRAG_SDXL.py         # 画像生成とプロンプト拡張のコアロジック
├── retrieval.py             # 画像検索（Retrieval）エンジン
├── utils.py                 # 共通ユーティリティ関数
└── environment.yml          # 環境構築用設定ファイル
```

